<script type="application/json" data-product-json>
  {{ product.variants | json }}
</script>

<section class="product section" data-product style="padding-top: {{ section.settings.padding_top }}px; padding-bottom: {{ section.settings.padding_bottom }}px;">
  <div class="container">
    <div class="product__grid">
      <!-- Product Gallery -->
      <div class="product__media">
        {% if product.images.size > 1 %}
          <div class="product__gallery" data-product-gallery>
            <div class="product__gallery-main">
              <div class="product__gallery-track" data-gallery-track>
                {% for image in product.images %}
                  <div class="product__gallery-slide{% if forloop.first %} is-active{% endif %}" data-slide-index="{{ forloop.index0 }}">
                    <img
                      src="{{ image | image_url: width: 800 }}"
                      srcset="
                        {{ image | image_url: width: 400 }} 400w,
                        {{ image | image_url: width: 600 }} 600w,
                        {{ image | image_url: width: 800 }} 800w,
                        {{ image | image_url: width: 1200 }} 1200w
                      "
                      sizes="(max-width: 768px) 100vw, 50vw"
                      alt="{{ image.alt | default: product.title | escape }}"
                      {% if forloop.first %}loading="eager"{% else %}loading="lazy"{% endif %}
                    >
                  </div>
                {% endfor %}
              </div>
              <button type="button" class="product__gallery-prev" data-gallery-prev aria-label="Previous image">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
              </button>
              <button type="button" class="product__gallery-next" data-gallery-next aria-label="Next image">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
              </button>
            </div>
            <div class="product__gallery-thumbs" data-gallery-thumbs>
              {% for image in product.images %}
                <button type="button" class="product__gallery-thumb{% if forloop.first %} is-active{% endif %}" data-thumb-index="{{ forloop.index0 }}" aria-label="View image {{ forloop.index }}">
                  <img
                    src="{{ image | image_url: width: 120 }}"
                    alt="{{ image.alt | default: product.title | escape }}"
                    loading="lazy"
                  >
                </button>
              {% endfor %}
            </div>
          </div>
        {% else %}
          <div class="product__media-main">
            {% if product.featured_image %}
              <img
                id="product-main-image"
                src="{{ product.featured_image | image_url: width: 800 }}"
                srcset="
                  {{ product.featured_image | image_url: width: 400 }} 400w,
                  {{ product.featured_image | image_url: width: 600 }} 600w,
                  {{ product.featured_image | image_url: width: 800 }} 800w,
                  {{ product.featured_image | image_url: width: 1200 }} 1200w
                "
                sizes="(max-width: 768px) 100vw, 50vw"
                alt="{{ product.featured_image.alt | default: product.title | escape }}"
                loading="eager"
                class="product__main-image"
              >
            {% else %}
              <div class="product__placeholder">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="var(--color-text-muted)" stroke-width="1">
                  <rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/>
                </svg>
              </div>
            {% endif %}
          </div>
        {% endif %}
      </div>

      <!-- Product Info -->
      <div class="product__info">
        {% for block in section.blocks %}
          {% case block.type %}

            {% when 'title' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                {% if section.settings.show_vendor and product.vendor != blank %}
                  <p class="product__vendor">{{ product.vendor }}</p>
                {% endif %}
                <h1 class="product__title" style="font-size: {% if section.settings.heading_size == 'small' %}1.5rem{% elsif section.settings.heading_size == 'large' %}2.5rem{% else %}2rem{% endif %};">{{ product.title }}</h1>
              </div>

            {% when 'price' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                <div class="product__price-wrap">
                  <span class="product__price" data-product-price>
                    {{ product.selected_or_first_available_variant.price | money }}
                  </span>
                  {% if product.selected_or_first_available_variant.compare_at_price > product.selected_or_first_available_variant.price %}
                    <span class="product__compare-price" data-compare-price>
                      {{ product.selected_or_first_available_variant.compare_at_price | money }}
                    </span>
                    <span class="product__save-badge">
                      Save {{ product.selected_or_first_available_variant.compare_at_price | minus: product.selected_or_first_available_variant.price | money }}
                    </span>
                  {% endif %}
                </div>
                {% if block.settings.show_tax_notice %}
                  <p class="product__tax-notice">{{ block.settings.tax_text }}</p>
                {% endif %}
              </div>

            {% when 'product_family_selector' %}
              {%- assign pf_size_meta = product.metafields.custom.configurator_size.value -%}
              {%- assign pf_tier_meta = product.metafields.custom.configurator_tier.value -%}
              {% if pf_size_meta != blank and pf_tier_meta != blank %}
                {%- assign pf_size = pf_size_meta | first | default: pf_size_meta -%}
                {%- assign pf_tier = pf_tier_meta | first | default: pf_tier_meta -%}
                {%- assign pf_oven = product.metafields.custom.oven_type.value | default: 'external' -%}
                {%- assign pf_tier_lower = pf_tier | downcase -%}
                {%- assign pf_is_integrated = false -%}
                {%- if pf_oven == 'integrated' -%}{%- assign pf_is_integrated = true -%}{%- endif -%}

                <div class="product__block product__family-selectors" {{ block.shopify_attributes }}>
                  {%- comment -%} Size selector {%- endcomment -%}
                  <div class="product__family-group">
                    <span class="product__family-label">Size</span>
                    <div class="product__family-btns" role="group" aria-label="Select size">
                      {%- assign pf_sizes = 'XL,L,M' | split: ',' -%}
                      {%- for s in pf_sizes -%}
                        {%- assign s_lower = s | downcase -%}
                        {%- assign pf_handle = 'nordic-elite-' | append: s_lower | append: '-' | append: pf_tier_lower -%}
                        {%- if pf_is_integrated and s != 'M' -%}
                          {%- assign pf_handle = pf_handle | append: '-i' -%}
                        {%- endif -%}
                        {%- assign pf_is_active = false -%}
                        {%- if s == pf_size -%}{%- assign pf_is_active = true -%}{%- endif -%}
                        {%- assign pf_dims = '' -%}
                        {%- if s == 'XL' -%}{%- assign pf_dims = block.settings.size_xl_dims -%}
                        {%- elsif s == 'L' -%}{%- assign pf_dims = block.settings.size_l_dims -%}
                        {%- elsif s == 'M' -%}{%- assign pf_dims = block.settings.size_m_dims -%}{%- endif -%}
                        <a href="{{ pf_handle | prepend: '/products/' }}"
                          class="product__family-btn{% if pf_is_active %} product__family-btn--active{% endif %}"
                          {% if pf_is_active %}aria-current="true"{% endif %}>
                          <span class="product__family-btn-name">{{ s }}</span>
                          {% if pf_dims != blank %}<span class="product__family-btn-sub">{{ pf_dims }}</span>{% endif %}
                        </a>
                      {%- endfor -%}
                    </div>
                  </div>

                  {%- comment -%} Tier / Collection selector {%- endcomment -%}
                  <div class="product__family-group">
                    <span class="product__family-label">Collection</span>
                    <div class="product__family-btns" role="group" aria-label="Select collection">
                      {%- assign pf_tiers = 'Classic,Premium,Signature' | split: ',' -%}
                      {%- assign pf_size_lower = pf_size | downcase -%}
                      {%- for t in pf_tiers -%}
                        {%- assign t_lower = t | downcase -%}
                        {%- assign pf_handle = 'nordic-elite-' | append: pf_size_lower | append: '-' | append: t_lower -%}
                        {%- if pf_is_integrated and pf_size != 'M' -%}
                          {%- assign pf_handle = pf_handle | append: '-i' -%}
                        {%- endif -%}
                        {%- assign pf_is_active = false -%}
                        {%- if t == pf_tier -%}{%- assign pf_is_active = true -%}{%- endif -%}
                        <a href="{{ pf_handle | prepend: '/products/' }}"
                          class="product__family-btn product__family-btn--tier-{{ t_lower }}{% if pf_is_active %} product__family-btn--active{% endif %}"
                          {% if pf_is_active %}aria-current="true"{% endif %}>
                          <span class="product__family-btn-name">{{ t }}</span>
                        </a>
                      {%- endfor -%}
                    </div>
                  </div>

                  {%- comment -%} Oven type toggle — hidden for M size {%- endcomment -%}
                  {%- if pf_size != 'M' -%}
                    <div class="product__family-group">
                      <span class="product__family-label">Oven Type</span>
                      <div class="product__family-btns product__family-btns--toggle" role="group" aria-label="Select oven type">
                        {%- assign pf_ext_handle = 'nordic-elite-' | append: pf_size_lower | append: '-' | append: pf_tier_lower -%}
                        {%- assign pf_int_handle = pf_ext_handle | append: '-i' -%}
                        <a href="{{ pf_ext_handle | prepend: '/products/' }}"
                          class="product__family-btn{% unless pf_is_integrated %} product__family-btn--active{% endunless %}"
                          {% unless pf_is_integrated %}aria-current="true"{% endunless %}>
                          <span class="product__family-btn-name">External</span>
                        </a>
                        <a href="{{ pf_int_handle | prepend: '/products/' }}"
                          class="product__family-btn{% if pf_is_integrated %} product__family-btn--active{% endif %}"
                          {% if pf_is_integrated %}aria-current="true"{% endif %}>
                          <span class="product__family-btn-name">Integrated</span>
                        </a>
                      </div>
                    </div>
                  {%- endif -%}
                </div>
              {% endif %}

            {% when 'variant_picker' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                {% unless product.has_only_default_variant %}
                  {% for option in product.options_with_values %}
                    {%- assign option_name_lower = option.name | downcase -%}
                    {%- assign is_color = false -%}
                    {%- if option_name_lower contains 'color' or option_name_lower contains 'colour' -%}
                      {%- assign is_color = true -%}
                    {%- endif -%}

                    <div class="product__option">
                      <label class="product__option-label" for="option-{{ option.name | handleize }}">
                        {{ option.name }}{% if is_color %}: <span class="product__swatch-selected-value" data-swatch-value="{{ forloop.index0 }}">{{ option.selected_value }}</span>{% endif %}
                      </label>

                      {% if is_color %}
                        <div class="product__swatches" data-swatch-group="{{ forloop.index0 }}">
                          {% for value in option.values %}
                            <button
                              type="button"
                              class="product__swatch{% if option.selected_value == value %} product__swatch--active{% endif %}"
                              data-swatch-index="{{ forloop.index0 }}"
                              data-swatch-option="{{ option.position | minus: 1 }}"
                              data-value="{{ value | escape }}"
                              title="{{ value }}"
                              aria-label="{{ option.name }}: {{ value }}"
                            >
                              <span class="product__swatch-inner" data-swatch-color="{{ value | handleize }}"></span>
                              <span class="product__swatch-name">{{ value }}</span>
                            </button>
                          {% endfor %}
                        </div>
                        <select
                          id="option-{{ option.name | handleize }}"
                          class="product__option-select product__option-select--hidden"
                          data-option-index="{{ forloop.index0 }}"
                          aria-hidden="true"
                          tabindex="-1"
                        >
                          {% for value in option.values %}
                            <option value="{{ value | escape }}" {% if option.selected_value == value %}selected{% endif %}>
                              {{ value }}
                            </option>
                          {% endfor %}
                        </select>
                      {% else %}
                        <select
                          id="option-{{ option.name | handleize }}"
                          class="product__option-select"
                          data-option-index="{{ forloop.index0 }}"
                        >
                          {% for value in option.values %}
                            <option value="{{ value | escape }}" {% if option.selected_value == value %}selected{% endif %}>
                              {{ value }}
                            </option>
                          {% endfor %}
                        </select>
                      {% endif %}
                    </div>
                  {% endfor %}
                {% endunless %}
              </div>

            {% when 'quantity_selector' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                <label class="product__option-label" for="product-quantity">Quantity</label>
                <div class="product__quantity">
                  <button type="button" class="product__quantity-btn" data-quantity-minus aria-label="Decrease quantity">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/></svg>
                  </button>
                  <input type="number" id="product-quantity" class="product__quantity-input" value="1" min="1" data-quantity-input>
                  <button type="button" class="product__quantity-btn" data-quantity-plus aria-label="Increase quantity">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                  </button>
                </div>
              </div>

            {% when 'buy_buttons' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                <form method="post" action="/cart/add" data-product-form>
                  <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}" data-variant-id>
                  <input type="hidden" name="quantity" value="1" data-form-quantity>
                  <button
                    type="submit"
                    class="button button--primary product__add-to-cart"
                    {% unless product.selected_or_first_available_variant.available %}disabled{% endunless %}
                  >
                    {% if product.selected_or_first_available_variant.available %}
                      {{ block.settings.button_text | default: 'Add to Cart' }}
                    {% else %}
                      Sold Out
                    {% endif %}
                  </button>
                  {% if block.settings.show_dynamic_checkout %}
                    {{ form | payment_button }}
                  {% endif %}
                </form>
              </div>

            {% when 'description' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                {% if product.description != blank %}
                  <div class="product__description rte">
                    {{ product.description }}
                  </div>
                {% endif %}
              </div>

            {% when 'collapsible_tab' %}
              <div class="product__block product__collapsible" {{ block.shopify_attributes }}>
                <button class="product__collapsible-trigger" data-collapsible-trigger aria-expanded="false">
                  <span>
                    {% if block.settings.icon != 'none' %}
                      <span class="product__collapsible-icon">
                        {% case block.settings.icon %}
                          {% when 'box' %}
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 002 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0022 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>
                          {% when 'truck' %}
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="1" y="3" width="15" height="13"/><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/></svg>
                          {% when 'shield' %}
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                          {% when 'ruler' %}
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 3H3v7h18V3z"/><path d="M6 10V7"/><path d="M9 10V5"/><path d="M12 10V7"/><path d="M15 10V5"/><path d="M18 10V7"/></svg>
                          {% when 'leaf' %}
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89-.82"/><path d="M17 8c4-1 6 3 6 3s-4 2-8 0"/><path d="M17 8l-5 5"/></svg>
                          {% when 'question' %}
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                        {% endcase %}
                      </span>
                    {% endif %}
                    {{ block.settings.heading }}
                  </span>
                  <svg class="product__collapsible-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                </button>
                <div class="product__collapsible-content" data-collapsible-content>
                  <div class="product__collapsible-inner rte">
                    {% if block.settings.page != blank %}
                      {{ block.settings.page.content }}
                    {% else %}
                      {{ block.settings.content }}
                    {% endif %}
                  </div>
                </div>
              </div>

            {% when 'share' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                <div class="product__share">
                  <span class="product__share-label">Share</span>
                  <div class="product__share-links">
                    <a href="https://www.facebook.com/sharer/sharer.php?u={{ shop.url }}{{ product.url }}" target="_blank" rel="noopener" aria-label="Share on Facebook" class="product__share-link">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg>
                    </a>
                    <a href="https://twitter.com/intent/tweet?url={{ shop.url }}{{ product.url }}&text={{ product.title | url_encode }}" target="_blank" rel="noopener" aria-label="Share on Twitter" class="product__share-link">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"/></svg>
                    </a>
                    <a href="mailto:?subject={{ product.title | url_encode }}&body={{ shop.url }}{{ product.url }}" aria-label="Share via email" class="product__share-link">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                    </a>
                  </div>
                </div>
              </div>

            {% when 'product_specs' %}
              <div class="product__block product__collapsible" {{ block.shopify_attributes }}>
                <button class="product__collapsible-trigger" data-collapsible-trigger aria-expanded="false">
                  <span>
                    {% if block.settings.icon != 'none' %}
                      <span class="product__collapsible-icon">
                        {% case block.settings.icon %}
                          {% when 'ruler' %}
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 3H3v7h18V3z"/><path d="M6 10V7"/><path d="M9 10V5"/><path d="M12 10V7"/><path d="M15 10V5"/><path d="M18 10V7"/></svg>
                          {% when 'box' %}
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 002 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0022 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>
                          {% when 'leaf' %}
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89-.82"/><path d="M17 8c4-1 6 3 6 3s-4 2-8 0"/><path d="M17 8l-5 5"/></svg>
                        {% endcase %}
                      </span>
                    {% endif %}
                    {{ block.settings.heading | default: 'Specifications' }}
                  </span>
                  <svg class="product__collapsible-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                </button>
                <div class="product__collapsible-content" data-collapsible-content>
                  <div class="product__collapsible-inner">
                    {%- assign has_specs = false -%}

                    {%- if product.metafields.custom.capacity != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.size != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.dimensions != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.height != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.diameter != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.inside_diameter != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.outside_diameter != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.exterior_material != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.fiberglass_type != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.liner_collection != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.hydro_massage != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.air_system != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.led_lighting != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.head_pillows != blank -%}{%- assign has_specs = true -%}{%- endif -%}
                    {%- if product.metafields.custom.oven_description != blank -%}{%- assign has_specs = true -%}{%- endif -%}

                    {% if has_specs %}
                      <table class="product__specs-table">
                        <tbody>
                          {%- if product.metafields.custom.capacity != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Capacity</td>
                              <td class="product__specs-value">{{ product.metafields.custom.capacity }}</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.size != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Size</td>
                              <td class="product__specs-value">{{ product.metafields.custom.size }}</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.dimensions != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Dimensions</td>
                              <td class="product__specs-value">{{ product.metafields.custom.dimensions }}</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.height != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Height</td>
                              <td class="product__specs-value">{{ product.metafields.custom.height }}</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.diameter != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Diameter</td>
                              <td class="product__specs-value">{{ product.metafields.custom.diameter }}</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.inside_diameter != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Inside Diameter</td>
                              <td class="product__specs-value">{{ product.metafields.custom.inside_diameter }} cm</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.outside_diameter != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Outside Diameter</td>
                              <td class="product__specs-value">{{ product.metafields.custom.outside_diameter }} cm</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.exterior_material != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Exterior Material</td>
                              <td class="product__specs-value">{{ product.metafields.custom.exterior_material }}</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.fiberglass_type != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Fiberglass Type</td>
                              <td class="product__specs-value">{{ product.metafields.custom.fiberglass_type }}</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.liner_collection != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Liner Collection</td>
                              <td class="product__specs-value">{{ product.metafields.custom.liner_collection }}</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.hydro_massage != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Hydro Massage</td>
                              <td class="product__specs-value">{{ product.metafields.custom.hydro_massage }}</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.air_system != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Air System</td>
                              <td class="product__specs-value">{{ product.metafields.custom.air_system }}</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.led_lighting != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">LED Lighting</td>
                              <td class="product__specs-value">{{ product.metafields.custom.led_lighting }}</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.head_pillows != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Head Pillows</td>
                              <td class="product__specs-value">{{ product.metafields.custom.head_pillows }}</td>
                            </tr>
                          {%- endif -%}
                          {%- if product.metafields.custom.oven_description != blank -%}
                            <tr class="product__specs-row">
                              <td class="product__specs-label">Oven</td>
                              <td class="product__specs-value">{{ product.metafields.custom.oven_description }}</td>
                            </tr>
                          {%- endif -%}
                        </tbody>
                      </table>
                    {% else %}
                      <p>No specifications available for this product.</p>
                    {% endif %}
                  </div>
                </div>
              </div>

            {% when 'custom_liquid' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                {{ block.settings.custom_liquid }}
              </div>

            {% when 'rating' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                <div class="product__rating">
                  <div class="product__rating-stars">
                    {% for i in (1..5) %}
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="{% if i <= block.settings.rating %}var(--color-accent){% else %}none{% endif %}" stroke="var(--color-accent)" stroke-width="1.5">
                        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                      </svg>
                    {% endfor %}
                  </div>
                  {% if block.settings.review_count > 0 %}
                    <span class="product__rating-count">({{ block.settings.review_count }} reviews)</span>
                  {% endif %}
                </div>
              </div>

            {% when 'separator' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                <hr class="product__separator">
              </div>

            {% when 'text' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                <div class="product__custom-text rte">
                  {{ block.settings.text }}
                </div>
              </div>

            {% when 'financing' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                <div class="product__financing">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--color-accent)" stroke-width="1.5">
                    <rect x="1" y="4" width="22" height="16" rx="2"/><line x1="1" y1="10" x2="23" y2="10"/>
                  </svg>
                  <span>{{ block.settings.financing_text }}</span>
                </div>
              </div>

            {% when 'feature_highlights' %}
              <div class="product__block" {{ block.shopify_attributes }}>
                <div class="product__highlights">
                  {%- assign hl_icons = block.settings.highlight_1_icon | append: ',' | append: block.settings.highlight_2_icon | append: ',' | append: block.settings.highlight_3_icon | append: ',' | append: block.settings.highlight_4_icon | split: ',' -%}
                  {%- assign hl_texts = 'highlight_1,highlight_2,highlight_3,highlight_4' | split: ',' -%}
                  {%- for hl_key in hl_texts -%}
                    {%- assign hl_text = block.settings[hl_key] -%}
                    {%- if hl_text != blank -%}
                      {%- assign hl_icon = hl_icons[forloop.index0] -%}
                      <div class="product__highlight">
                        <span class="product__highlight-icon">
                          {%- if hl_icon == 'check' or hl_icon == blank -%}
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                          {%- else -%}
                            {%- render 'icon', name: hl_icon, size: 16 -%}
                          {%- endif -%}
                        </span>
                        <span>{{ hl_text }}</span>
                      </div>
                    {%- endif -%}
                  {%- endfor -%}
                </div>
              </div>

          {% endcase %}
        {% endfor %}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Product Page",
  "tag": "section",
  "class": "section-product",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Show vendor",
      "default": true
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Title size",
      "options": [
        { "value": "small", "label": "Small" },
        { "value": "medium", "label": "Medium" },
        { "value": "large", "label": "Large" }
      ],
      "default": "medium"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "gallery_layout",
      "label": "Gallery layout",
      "options": [
        { "value": "thumbnails_bottom", "label": "Thumbnails below" },
        { "value": "thumbnails_left", "label": "Thumbnails left" }
      ],
      "default": "thumbnails_bottom"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Top padding",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 40,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Bottom padding",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 40,
      "unit": "px"
    }
  ],
  "blocks": [
    {
      "type": "title",
      "name": "Title",
      "limit": 1
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_tax_notice",
          "label": "Show tax notice",
          "default": false
        },
        {
          "type": "text",
          "id": "tax_text",
          "label": "Tax notice text",
          "default": "Tax included. Shipping calculated at checkout."
        }
      ]
    },
    {
      "type": "variant_picker",
      "name": "Variant Picker",
      "limit": 1
    },
    {
      "type": "quantity_selector",
      "name": "Quantity Selector",
      "limit": 1
    },
    {
      "type": "buy_buttons",
      "name": "Buy Buttons",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "button_text",
          "label": "Add to cart text",
          "default": "Add to Cart"
        },
        {
          "type": "checkbox",
          "id": "show_dynamic_checkout",
          "label": "Show dynamic checkout button",
          "default": true
        }
      ]
    },
    {
      "type": "description",
      "name": "Description",
      "limit": 1
    },
    {
      "type": "collapsible_tab",
      "name": "Collapsible Tab",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Specifications"
        },
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "options": [
            { "value": "none", "label": "None" },
            { "value": "box", "label": "Package" },
            { "value": "truck", "label": "Shipping" },
            { "value": "shield", "label": "Warranty" },
            { "value": "ruler", "label": "Dimensions" },
            { "value": "leaf", "label": "Materials" },
            { "value": "question", "label": "FAQ" }
          ],
          "default": "box"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Content",
          "default": "<p>Share product specifications or other details here.</p>"
        },
        {
          "type": "page",
          "id": "page",
          "label": "Or use content from page"
        }
      ]
    },
    {
      "type": "product_specs",
      "name": "Product Specifications",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Specifications"
        },
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "options": [
            { "value": "none", "label": "None" },
            { "value": "ruler", "label": "Dimensions" },
            { "value": "box", "label": "Package" },
            { "value": "leaf", "label": "Materials" }
          ],
          "default": "ruler"
        }
      ]
    },
    {
      "type": "product_family_selector",
      "name": "Product Family Selector",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "size_xl_dims",
          "label": "XL dimensions",
          "default": "Ø200/225 cm"
        },
        {
          "type": "text",
          "id": "size_l_dims",
          "label": "L dimensions",
          "default": "Ø180/200 cm"
        },
        {
          "type": "text",
          "id": "size_m_dims",
          "label": "M dimensions",
          "default": "100×180/120×200 cm"
        }
      ]
    },
    {
      "type": "separator",
      "name": "Separator"
    },
    {
      "type": "text",
      "name": "Custom Text",
      "settings": [
        {
          "type": "richtext",
          "id": "text",
          "label": "Text",
          "default": "<p>Pair text with an image to focus on your chosen product, collection, or blog post.</p>"
        }
      ]
    },
    {
      "type": "share",
      "name": "Share",
      "limit": 1
    },
    {
      "type": "rating",
      "name": "Star Rating",
      "limit": 1,
      "settings": [
        {
          "type": "range",
          "id": "rating",
          "label": "Rating",
          "min": 1,
          "max": 5,
          "step": 1,
          "default": 5
        },
        {
          "type": "number",
          "id": "review_count",
          "label": "Review count",
          "default": 0
        }
      ]
    },
    {
      "type": "custom_liquid",
      "name": "Custom Liquid",
      "settings": [
        {
          "type": "liquid",
          "id": "custom_liquid",
          "label": "Custom Liquid"
        }
      ]
    },
    {
      "type": "financing",
      "name": "Financing Callout",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "financing_text",
          "label": "Financing text",
          "default": "Starting from €49/month with financing"
        }
      ]
    },
    {
      "type": "feature_highlights",
      "name": "Feature Highlights",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "highlight_1",
          "label": "Highlight 1",
          "default": "No ice needed"
        },
        {
          "type": "select",
          "id": "highlight_1_icon",
          "label": "Highlight 1 icon",
          "default": "snowflake",
          "options": [
            { "value": "check", "label": "Checkmark" },
            { "value": "snowflake", "label": "Snowflake" },
            { "value": "thermometer", "label": "Thermometer" },
            { "value": "droplet", "label": "Droplet" },
            { "value": "flame", "label": "Flame" },
            { "value": "shield", "label": "Shield" },
            { "value": "leaf", "label": "Leaf" },
            { "value": "star", "label": "Star" },
            { "value": "heart", "label": "Heart" },
            { "value": "zap", "label": "Zap" },
            { "value": "sun", "label": "Sun" },
            { "value": "moon", "label": "Moon" },
            { "value": "wind", "label": "Wind" },
            { "value": "waves", "label": "Waves" },
            { "value": "truck", "label": "Truck" },
            { "value": "clock", "label": "Clock" },
            { "value": "users", "label": "Users" },
            { "value": "award", "label": "Award" },
            { "value": "tool", "label": "Tool" },
            { "value": "settings", "label": "Settings" },
            { "value": "lock", "label": "Lock" },
            { "value": "refresh", "label": "Refresh" },
            { "value": "gift", "label": "Gift" },
            { "value": "tag", "label": "Tag" },
            { "value": "percent", "label": "Percent" },
            { "value": "life-buoy", "label": "Life buoy" },
            { "value": "anchor", "label": "Anchor" },
            { "value": "compass", "label": "Compass" },
            { "value": "globe", "label": "Globe" },
            { "value": "coffee", "label": "Coffee" }
          ]
        },
        {
          "type": "text",
          "id": "highlight_2",
          "label": "Highlight 2",
          "default": "Always cold"
        },
        {
          "type": "select",
          "id": "highlight_2_icon",
          "label": "Highlight 2 icon",
          "default": "thermometer",
          "options": [
            { "value": "check", "label": "Checkmark" },
            { "value": "snowflake", "label": "Snowflake" },
            { "value": "thermometer", "label": "Thermometer" },
            { "value": "droplet", "label": "Droplet" },
            { "value": "flame", "label": "Flame" },
            { "value": "shield", "label": "Shield" },
            { "value": "leaf", "label": "Leaf" },
            { "value": "star", "label": "Star" },
            { "value": "heart", "label": "Heart" },
            { "value": "zap", "label": "Zap" },
            { "value": "sun", "label": "Sun" },
            { "value": "moon", "label": "Moon" },
            { "value": "wind", "label": "Wind" },
            { "value": "waves", "label": "Waves" },
            { "value": "truck", "label": "Truck" },
            { "value": "clock", "label": "Clock" },
            { "value": "users", "label": "Users" },
            { "value": "award", "label": "Award" },
            { "value": "tool", "label": "Tool" },
            { "value": "settings", "label": "Settings" },
            { "value": "lock", "label": "Lock" },
            { "value": "refresh", "label": "Refresh" },
            { "value": "gift", "label": "Gift" },
            { "value": "tag", "label": "Tag" },
            { "value": "percent", "label": "Percent" },
            { "value": "life-buoy", "label": "Life buoy" },
            { "value": "anchor", "label": "Anchor" },
            { "value": "compass", "label": "Compass" },
            { "value": "globe", "label": "Globe" },
            { "value": "coffee", "label": "Coffee" }
          ]
        },
        {
          "type": "text",
          "id": "highlight_3",
          "label": "Highlight 3",
          "default": "Easy maintenance"
        },
        {
          "type": "select",
          "id": "highlight_3_icon",
          "label": "Highlight 3 icon",
          "default": "tool",
          "options": [
            { "value": "check", "label": "Checkmark" },
            { "value": "snowflake", "label": "Snowflake" },
            { "value": "thermometer", "label": "Thermometer" },
            { "value": "droplet", "label": "Droplet" },
            { "value": "flame", "label": "Flame" },
            { "value": "shield", "label": "Shield" },
            { "value": "leaf", "label": "Leaf" },
            { "value": "star", "label": "Star" },
            { "value": "heart", "label": "Heart" },
            { "value": "zap", "label": "Zap" },
            { "value": "sun", "label": "Sun" },
            { "value": "moon", "label": "Moon" },
            { "value": "wind", "label": "Wind" },
            { "value": "waves", "label": "Waves" },
            { "value": "truck", "label": "Truck" },
            { "value": "clock", "label": "Clock" },
            { "value": "users", "label": "Users" },
            { "value": "award", "label": "Award" },
            { "value": "tool", "label": "Tool" },
            { "value": "settings", "label": "Settings" },
            { "value": "lock", "label": "Lock" },
            { "value": "refresh", "label": "Refresh" },
            { "value": "gift", "label": "Gift" },
            { "value": "tag", "label": "Tag" },
            { "value": "percent", "label": "Percent" },
            { "value": "life-buoy", "label": "Life buoy" },
            { "value": "anchor", "label": "Anchor" },
            { "value": "compass", "label": "Compass" },
            { "value": "globe", "label": "Globe" },
            { "value": "coffee", "label": "Coffee" }
          ]
        },
        {
          "type": "text",
          "id": "highlight_4",
          "label": "Highlight 4",
          "default": "Energy efficient"
        },
        {
          "type": "select",
          "id": "highlight_4_icon",
          "label": "Highlight 4 icon",
          "default": "zap",
          "options": [
            { "value": "check", "label": "Checkmark" },
            { "value": "snowflake", "label": "Snowflake" },
            { "value": "thermometer", "label": "Thermometer" },
            { "value": "droplet", "label": "Droplet" },
            { "value": "flame", "label": "Flame" },
            { "value": "shield", "label": "Shield" },
            { "value": "leaf", "label": "Leaf" },
            { "value": "star", "label": "Star" },
            { "value": "heart", "label": "Heart" },
            { "value": "zap", "label": "Zap" },
            { "value": "sun", "label": "Sun" },
            { "value": "moon", "label": "Moon" },
            { "value": "wind", "label": "Wind" },
            { "value": "waves", "label": "Waves" },
            { "value": "truck", "label": "Truck" },
            { "value": "clock", "label": "Clock" },
            { "value": "users", "label": "Users" },
            { "value": "award", "label": "Award" },
            { "value": "tool", "label": "Tool" },
            { "value": "settings", "label": "Settings" },
            { "value": "lock", "label": "Lock" },
            { "value": "refresh", "label": "Refresh" },
            { "value": "gift", "label": "Gift" },
            { "value": "tag", "label": "Tag" },
            { "value": "percent", "label": "Percent" },
            { "value": "life-buoy", "label": "Life buoy" },
            { "value": "anchor", "label": "Anchor" },
            { "value": "compass", "label": "Compass" },
            { "value": "globe", "label": "Globe" },
            { "value": "coffee", "label": "Coffee" }
          ]
        }
      ]
    }
  ]
}
{% endschema %}
